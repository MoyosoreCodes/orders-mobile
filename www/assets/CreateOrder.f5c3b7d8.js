import{_ as y,z as u,G as d,F as r,D as t,Q as l,B as c,H as g,Z as m,$ as f}from"./index.09c00735.js";import{a as q,Q as _,u as b,b as x,c as h}from"./use-quasar.1ca94313.js";const k={name:"CreateOrder",setup(){return{quasar:b()}},data(){return{products:[{id:Math.floor(Math.random()*9999),name:"",quantity:1}]}},methods:{createOrder(){if(!this.quasar.localStorage.has("token")){this.quasar.notify({color:"negative",message:"Unauthorized, login to continue"}),this.$router.push({path:"/login"});return}this.quasar.loadingBar.setDefaults({color:"secondary",size:"15px",position:"bottom"}),this.quasar.loadingBar.start();const o=this.quasar.localStorage.getItem("token"),i={products:[...this.products.map(a=>({name:a.name,quantity:a.quantity}))]};q.post("orders",JSON.stringify(i),{headers:{Authorization:o,"Access-Control-Allow-Origin":"*","Content-Type":"application/json"}}).then(({data:a})=>{a.statusCode!==201?this.quasar.notify({message:a.message,color:"negative"}):this.quasar.notify({message:a.message,color:"secondary"}),this.quasar.loadingBar.stop()}).catch(a=>{this.quasar.notify({message:"network error, please contact support",color:"negative"})})},resetForm(){this.products=[{id:Math.floor(Math.random()*9999),name:"",quantity:1}]},addEntry(){this.products.push({id:Math.floor(Math.random()*9999),name:"",quantity:1})},removeEntry(o){if(this.products.length<=1)return this.products;this.products=this.products.filter(i=>o!=i.id)},logout(){this.quasar.localStorage.set("token",null),this.$router.push({path:"/login"})}}},C={class:"column items-end",style:{margin:"10px 5px"}},v={class:"column items-center col-auto",style:{margin:"10px 0"}},Q={class:"col 6",style:{"min-width":"400px"}},V=r("div",{class:"text-h5 text-center text-weight-bold",style:{margin:"20px 0"}},"Create a new order",-1),w={style:{margin:"3px"},class:"align-self:center"};function B(o,i,a,M,p,n){return u(),d(m,null,[r("div",C,[t(l,{label:"Logout",type:"submit",color:"primary",onClick:n.logout},null,8,["onClick"])]),r("div",v,[r("div",Q,[t(_,{style:{padding:"5px"},onSubmit:g(n.createOrder,["prevent"]),onReset:n.resetForm},{default:c(()=>[V,t(x),(u(!0),d(m,null,f(p.products,s=>(u(),d("div",{key:s.id},[r("div",null,[t(h,{filled:"",modelValue:s.name,"onUpdate:modelValue":e=>s.name=e,label:"Product name","lazy-rules":"",rules:[e=>e&&e.length>0||"name of product is required"]},null,8,["modelValue","onUpdate:modelValue","rules"]),t(h,{filled:"",modelValue:s.quantity,"onUpdate:modelValue":e=>s.quantity=e,type:"number",label:"Quantity","lazy-rules":"",rules:[e=>e!==null&&e!==""||"Quantity is required",e=>e>0||"Quantity cannot be less than 1"]},{after:c(()=>[t(l,{round:"",dense:"",flat:"",icon:"add",color:"white",class:"bg-blue",onClick:n.addEntry},null,8,["onClick"]),t(l,{round:"",dense:"",flat:"",icon:"delete",color:"white",class:"bg-blue",onClick:e=>n.removeEntry(s.id)},null,8,["onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue","rules"])])]))),128)),r("div",w,[t(l,{label:"Create product",type:"submit",color:"primary"}),t(l,{label:"Reset",type:"reset",color:"primary",flat:"",class:"q-ml-sm"})])]),_:1},8,["onSubmit","onReset"])])])],64)}var O=y(k,[["render",B]]);export{O as default};
